<div class="w-100">
    <ul class="nav nav-tabs nav-tabs-highlight mb-0">
        <li class="nav-item">
            <a href="#ea-master-search" class="nav-link active show p-2" data-toggle="tab">
                <i class="icon-search4 ml-4 mr-4"></i>
            </a>
        </li>
        <li class="nav-item">
            <a href="#ea-graph" class="nav-link p-2" data-toggle="tab">
                <i class="icon-graph ml-4 mr-4"></i>
            </a>
        </li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane fade active show" id="ea-master-search">
            <div class="d-flex ea-mastersearch">
                <div class="leftsidebar">
                    <div class="tree-checkbox-hierarchical border-0">
                        <ul class="mb-0">
                            <li class="folder expanded">Expanded folder with children
                                <ul>
                                    <li class="expanded">Expanded sub-item
                                        <ul>
                                            <li>Menu sub-item</li>
                                            <li class="selected">This is a selected item</li>
                                        </ul>
                                    </li>
                                    <li>Collapsed sub-item
                                        <ul>
                                            <li>Sub-item 2.2.1</li>
                                            <li>Sub-item 2.2.2</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="popup" title="Look, a tool tip!">Menu item with key and tooltip</li>
                            <li class="folder">Collapsed folder
                                <ul>
                                    <li>Sub-item 1.1</li>
                                    <li>Sub-item 1.2</li>
                                </ul>
                            </li>
                            <li>Basic <i>menu item</i> with <strong class="font-weight-semibold">HTML support</strong></li>
                            <li class="expanded">Document with some children
                                <ul>
                                    <li class="selected">Document sub-item</li>
                                    <li class="selected">Another document sub-item</li>
                                </ul>
                            </li>
                            <li class="folder">Collapsed folder
                                <ul>
                                    <li>Sub-item 1.1</li>
                                    <li>Sub-item 1.2</li>
                                </ul>
                            </li>
                            <li class="folder expanded">Expanded folder with children
                                <ul>
                                    <li class="expanded">Expanded sub-item
                                        <ul>
                                            <li>Menu sub-item</li>
                                            <li class="selected">This is a selected item</li>
                                        </ul>
                                    </li>
                                    <li>Collapsed sub-item
                                        <ul>
                                            <li>Sub-item 2.2.1</li>
                                            <li>Sub-item 2.2.2</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="popup" title="Look, a tool tip!">Menu item with key and tooltip</li>
                            <li class="folder">Collapsed folder
                                <ul>
                                    <li>Sub-item 1.1</li>
                                    <li>Sub-item 1.2</li>
                                </ul>
                            </li>
                            <li>Basic <i>menu item</i> with <strong class="font-weight-semibold">HTML support</strong></li>
                            <li class="expanded">Document with some children
                                <ul>
                                    <li class="selected">Document sub-item</li>
                                    <li class="selected">Another document sub-item</li>
                                </ul>
                            </li>
                            <li class="folder">Collapsed folder
                                <ul>
                                    <li>Sub-item 1.1</li>
                                    <li>Sub-item 1.2</li>
                                </ul>
                            </li>
                            <li class="folder expanded">Expanded folder with children
                                <ul>
                                    <li class="expanded">Expanded sub-item
                                        <ul>
                                            <li>Menu sub-item</li>
                                            <li class="selected">This is a selected item</li>
                                        </ul>
                                    </li>
                                    <li>Collapsed sub-item
                                        <ul>
                                            <li>Sub-item 2.2.1</li>
                                            <li>Sub-item 2.2.2</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="popup" title="Look, a tool tip!">Menu item with key and tooltip</li>
                            <li class="folder">Collapsed folder
                                <ul>
                                    <li>Sub-item 1.1</li>
                                    <li>Sub-item 1.2</li>
                                </ul>
                            </li>
                            <li>Basic <i>menu item</i> with <strong class="font-weight-semibold">HTML support</strong></li>
                            <li class="expanded">Document with some children
                                <ul>
                                    <li class="selected">Document sub-item</li>
                                    <li class="selected">Another document sub-item</li>
                                </ul>
                            </li>
                            <li class="folder">Collapsed folder
                                <ul>
                                    <li>Sub-item 1.1</li>
                                    <li>Sub-item 1.2</li>
                                </ul>
                            </li>
                        </ul>
                    </div> 
                </div>
                <div class="w-100 pl-3 pr-0 bg-white ea-master-result">
                    <table class="table datatable-scroll-y">
                        <thead>
                            <tr>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Job Title</th>
                                <th>DOB</th>
                                <th>Status</th>
                                <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Marth</td>
                                <td><a href="javascript:void(0);">Enright</a></td>
                                <td>Traffic Court Referee</td>
                                <td>22 Jun 1972</td>
                                <td><span class="badge badge-success">Active</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Jackelyn</td>
                                <td>Weible</td>
                                <td><a href="javascript:void(0);">Airline Transport Pilot</a></td>
                                <td>3 Oct 1981</td>
                                <td><span class="badge badge-secondary">Inactive</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Aura</td>
                                <td>Hard</td>
                                <td>Business Services Sales Representative</td>
                                <td>19 Apr 1969</td>
                                <td><span class="badge badge-danger">Suspended</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Nathalie</td>
                                <td><a href="javascript:void(0);">Pretty</a></td>
                                <td>Drywall Stripper</td>
                                <td>13 Dec 1977</td>
                                <td><span class="badge badge-info">Pending</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Sharan</td>
                                <td>Leland</td>
                                <td>Aviation Tactical Readiness Officer</td>
                                <td>30 Dec 1991</td>
                                <td><span class="badge badge-secondary">Inactive</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Maxine</td>
                                <td><a href="javascript:void(0);">Woldt</a></td>
                                <td><a href="javascript:void(0);">Business Services Sales Representative</a></td>
                                <td>17 Oct 1987</td>
                                <td><span class="badge badge-info">Pending</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Sylvia</td>
                                <td><a href="javascript:void(0);">Mcgaughy</a></td>
                                <td>Hemodialysis Technician</td>
                                <td>11 Nov 1983</td>
                                <td><span class="badge badge-danger">Suspended</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Lizzee</td>
                                <td><a href="javascript:void(0);">Goodlow</a></td>
                                <td>Technical Services Librarian</td>
                                <td>1 Nov 1961</td>
                                <td><span class="badge badge-danger">Suspended</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Kennedy</td>
                                <td>Haley</td>
                                <td>Senior Marketing Designer</td>
                                <td>18 Dec 1960</td>
                                <td><span class="badge badge-success">Active</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Chantal</td>
                                <td><a href="javascript:void(0);">Nailor</a></td>
                                <td>Technical Services Librarian</td>
                                <td>10 Jan 1980</td>
                                <td><span class="badge badge-secondary">Inactive</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Delma</td>
                                <td>Bonds</td>
                                <td>Lead Brand Manager</td>
                                <td>21 Dec 1968</td>
                                <td><span class="badge badge-info">Pending</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Roland</td>
                                <td>Salmos</td>
                                <td><a href="javascript:void(0);">Senior Program Developer</a></td>
                                <td>5 Jun 1986</td>
                                <td><span class="badge badge-secondary">Inactive</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Coy</td>
                                <td>Wollard</td>
                                <td>Customer Service Operator</td>
                                <td>12 Oct 1982</td>
                                <td><span class="badge badge-success">Active</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Maxwell</td>
                                <td>Maben</td>
                                <td>Regional Representative</td>
                                <td>25 Feb 1988</td>
                                <td><span class="badge badge-danger">Suspended</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>Cicely</td>
                                <td>Sigler</td>
                                <td><a href="javascript:void(0);">Senior Research Officer</a></td>
                                <td>15 Mar 1960</td>
                                <td><span class="badge badge-info">Pending</span></td>
                                <td class="text-center">
                                    <div class="list-icons">
                                        <div class="dropdown">
                                            <a href="javascript:void(0);"class="list-icons-item" data-toggle="dropdown">
                                                <i class="icon-menu9"></i>
                                            </a>

                                            <div class="dropdown-menu dropdown-menu-right">
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-pdf"></i> Export to .pdf</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-excel"></i> Export to .csv</a>
                                                <a href="javascript:void(0);"class="dropdown-item"><i class="icon-file-word"></i> Export to .doc</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="ea-graph">
            <?php
            if ($this->isAjax == false) {
                if (Config::getFromCache('CONFIG_MULTI_TAB')) {
            ?>
            <div class="card light shadow card-multi-tab">
                <div class="card-header header-elements-inline tabbable-line">
                    <ul class="nav nav-tabs card-multi-tab-navtabs">
                        <li>
                            <a href="#app_tab_mdlayouttreetemplate" class="active" data-toggle="tab"><i class="fa fa-caret-right"></i> <?php echo $this->title; ?><span><i class="fa fa-times-circle"></i></span></a>
                        </li>
                    </ul>
                    <div class="header-elements">
                        <div class="list-icons">
                            <a class="list-icons-item" data-action="fullscreen"></a>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="tab-content card-multi-tab-content">
                        <div class="tab-pane active" id="app_tab_mdlayouttreetemplate">
                            
                            <div class="tree-model-<?php echo $this->uniqId ?>">
                                <div class="clearfix w-100"></div>
                                <div class="mt10 mb10">
                                    <?php 
                                    if (isset($this->legendData) && $this->legendData) {
                                        foreach ($this->legendData as $key => $row) {
                                            $criteria = Str::htmlCharToDoubleQuote($row['criteria']);
                                            $rowJson = ''; 
                                    ?> 
                                        <span class="legend-tree" data-rowdata='<?php echo urlencode(json_encode($row)); ?>' onclick="clickCriteria_<?php echo $this->uniqId; ?>(this, '<?php echo $row['id'] ?>', '<?php echo $row['id'] ?>', '<?php echo $rowJson; ?>', '<?php echo $row['name'] ?>', '<?php echo $row['color']; ?>')"><i class="fa fa-circle" style="color:<?php echo $row['color']; ?>"></i> <?php echo $row['name'] ?> </span>
                                    <?php 
                                        }
                                    } 
                                    ?>
                                </div>

                                <div class="col-md-12 mt0" style="background: #FFF;" id="d3-tree-model-<?php echo $this->uniqId ?>"></div>
                            </div>
                            
                            <?php echo isset($this->tree) ? $this->tree : ''; ?>
                        </div>
                    </div>
                </div>
            </div>
            <?php }} else {
            ?>
            <div class="tree-model-<?php echo $this->uniqId ?>">
                <div class="clearfix w-100"></div>
                <div class="mt10 mb10">
                    <?php 
                    if (isset($this->legendData) && $this->legendData) {
                        foreach ($this->legendData as $key => $row) {
                            $criteria = Str::htmlCharToDoubleQuote($row['criteria']);
                            $rowJson = ''; 
                    ?> 
                        <span class="legend-tree" data-rowdata='<?php echo urlencode(json_encode($row)); ?>' onclick="clickCriteria_<?php echo $this->uniqId; ?>(this, '<?php echo $row['id'] ?>', '<?php echo $row['id'] ?>', '<?php echo $rowJson; ?>', '<?php echo $row['name'] ?>', '<?php echo $row['color']; ?>')"><i class="fa fa-circle" style="color:<?php echo $row['color']; ?>"></i> <?php echo $row['name'] ?> </span>
                    <?php 
                        }
                    } 
                    ?>
                </div>

                <div class="col-md-12 mt0" style="background: #FFF;" id="d3-tree-model-<?php echo $this->uniqId ?>"></div>
            </div>
            <?php echo isset($this->tree) ? $this->tree : ''; } ?>
        </div>
    </div>
</div>

<script type="text/javascript">
    $.getScript("assets/core/js/plugins/trees/fancytree_all.min.js");
    $.getScript("assets/core/js/plugins/trees/extra_trees.js");
    $.getScript("assets/core/js/plugins/tables/datatables/datatables.min.js");
    $.getScript("assets/core/js/plugins/tables/datatables/datatables_basic.js");
    
    var IS_LOAD_D3_V2_SCRIPT = false;
    
    $(document).ready(function () {
        
        <?php if (isset($this->colorPath)) { ?>
            var params = {
                legendData: <?php echo json_encode($this->legendData); ?>, 
                id: '<?php echo $this->id ?>',
                processId: '<?php echo $this->processId ?>',
                chartType: ('<?php echo $this->chartType; ?>').toLowerCase(),
                treeTemplate: '1'
            };
        <?php } else { ?>
            var params = {
                legendData: <?php echo json_encode($this->legendData); ?>, 
                id: '<?php echo $this->id ?>',
                processId: '<?php echo $this->processId ?>',
                chartType: ('<?php echo $this->chartType; ?>').toLowerCase(),
            };
        <?php } ?>
        
        $.ajax({
            type: 'post',
            url: 'mdlayout/getTreeJsonData',
            data: params,
            dataType: "json",
            beforeSend: function () {
                Core.blockUI({
                    message: 'Loading...',
                    boxed: true
                });
            },
            success: function (response) {
                if (response.status === 'success' && typeof response.data !== 'undefined' && response.data.length != 0) {
                    D3TreeCollapsible_<?php echo $this->uniqId ?>.init(response.data);
                } else {
                    PNotify.removeAll();
                    new PNotify({
                        title: 'Error',
                        text: 'Өгөгдөл олдсонгүй',
                        type: 'error',
                        sticker: false
                    });
                }

                Core.unblockUI();
            },
            error: function (jqXHR, exception) {
                var msg = '';
                if (jqXHR.status === 0) {
                    msg = 'Not connect.\n Verify Network.';
                } 
                else if (jqXHR.status == 404) {
                    msg = 'Requested page not found. [404]';
                } 
                else if (jqXHR.status == 500) {
                    msg = 'Internal Server Error [500].';
                } 
                else if (exception === 'parsererror') {
                    msg = 'Requested JSON parse failed.';
                } 
                else if (exception === 'timeout') {
                    msg = 'Time out error.';
                } 
                else if (exception === 'abort') {
                    msg = 'Ajax request aborted.';
                } 
                else {
                    msg = 'Uncaught Error.\n' + jqXHR.responseText;
                }

                PNotify.removeAll();
                new PNotify({
                    title: 'Error',
                    text: msg,
                    type: 'error',
                    sticker: false
                });
                Core.unblockUI();
            }
        });
        
    });
    
    function clickCriteria_<?php echo $this->uniqId; ?>(element, categoryId, id, criteria, name, color) {
        var $curr = $(element), legend = [], $prevs = $curr.prevAll();
        
        $prevs.each(function(){
            legend.push(JSON.parse(decodeURIComponent($(this).data('rowdata'))));
        });
        legend.push(JSON.parse(decodeURIComponent($curr.data('rowdata'))));
        
        <?php if (isset($this->colorPath)) { ?>
            var params = {
                legendData: <?php echo json_encode($this->legendData); ?>, 
                id: '<?php echo $this->id ?>',
                processId: '<?php echo $this->processId ?>',
                chartType: ('<?php echo $this->chartType; ?>').toLowerCase(),
                categoryId: categoryId,
                treeTemplate: '1'
            };
        <?php } else { ?>
            var params = {
                legendData: legend, 
                id: '<?php echo $this->id ?>',
                processId: '<?php echo $this->processId ?>',
                chartType: ('<?php echo $this->chartType; ?>').toLowerCase(),
                categoryId: categoryId
            };
        <?php } ?>
        $.ajax({
            type: 'post',
            url: 'mdlayout/getTreeJsonData',
            data: params,
            dataType: "json",
            beforeSend: function () {
                Core.blockUI({
                    message: 'Loading...',
                    boxed: true
                });
            },
            success: function (response) {
                if (response.status === 'success' && typeof response.data !== 'undefined' && response.data.length != 0) {
                    $('#d3-tree-model-<?php echo $this->uniqId ?>').empty();
                    D3TreeCollapsible_<?php echo $this->uniqId ?>.init(response.data);
                } else {
                    PNotify.removeAll();
                    new PNotify({
                        title: 'Error',
                        text: 'Өгөгдөл олдсонгүй',
                        type: 'error',
                        sticker: false
                    });
                }

                Core.unblockUI();
            },
            error: function (jqXHR, exception) {
                var msg = '';
                if (jqXHR.status === 0) {
                    msg = 'Not connect.\n Verify Network.';
                } 
                else if (jqXHR.status == 404) {
                    msg = 'Requested page not found. [404]';
                } 
                else if (jqXHR.status == 500) {
                    msg = 'Internal Server Error [500].';
                } 
                else if (exception === 'parsererror') {
                    msg = 'Requested JSON parse failed.';
                } 
                else if (exception === 'timeout') {
                    msg = 'Time out error.';
                } 
                else if (exception === 'abort') {
                    msg = 'Ajax request aborted.';
                } 
                else {
                    msg = 'Uncaught Error.\n' + jqXHR.responseText;
                }

                PNotify.removeAll();
                new PNotify({
                    title: 'Error',
                    text: msg,
                    type: 'error',
                    sticker: false
                });
                Core.unblockUI();
            }
        });
    }
</script>

<style type="text/css">
    .legend-tree {
        padding: 5px;
    }
    .legend-tree:hover {
        cursor: pointer;
        background: #d3e7f9;
    }
</style>